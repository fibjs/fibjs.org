<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Javascript on Fiber: Semaphore Interface Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Javascript on Fiber
   </div>
   <div id="projectbrief">A developement framework of the coroutines based on Google&#39;s V8 Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Tutorial</span></a></li>
      <li><a href="../../namespaces.html"><span>Module</span></a></li>
      <li><a href="../../annotated.html"><span>Object</span></a></li>
      <li><a href="https://github.com/xicilion/fibjs"><span>Download</span></a></li>
      <li><a href="http://named.cn/fibjs"><span>Forum</span></a></li>
      <li><a href="../../../index.html"><span>中文版</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dc/d90/interfaceSemaphore.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../db/dbd/interfaceSemaphore-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Semaphore Interface Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="../../dc/d90/interfaceSemaphore.html" title="Semaphore object. ">Semaphore</a> object.  
 <a href="../../dc/d90/interfaceSemaphore.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Semaphore:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 0 -->
</div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adf61e8770130c9f386c7c78934028379"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d90/interfaceSemaphore.html#adf61e8770130c9f386c7c78934028379">Semaphore</a> (Integer value=1)</td></tr>
<tr class="memdesc:adf61e8770130c9f386c7c78934028379"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#adf61e8770130c9f386c7c78934028379">More...</a><br /></td></tr>
<tr class="separator:adf61e8770130c9f386c7c78934028379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab144395cba916969214bbe60f7521fed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d90/interfaceSemaphore.html#ab144395cba916969214bbe60f7521fed">wait</a> ()</td></tr>
<tr class="memdesc:ab144395cba916969214bbe60f7521fed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for semaphore, same as acquire(true)  <a href="#ab144395cba916969214bbe60f7521fed">More...</a><br /></td></tr>
<tr class="separator:ab144395cba916969214bbe60f7521fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b45b66bfcb4fd6a03c998dd8e21d27e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d90/interfaceSemaphore.html#a2b45b66bfcb4fd6a03c998dd8e21d27e">post</a> ()</td></tr>
<tr class="memdesc:a2b45b66bfcb4fd6a03c998dd8e21d27e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post a semaphore, same as <a class="el" href="../../de/da6/interfaceLock.html#ad11a1833268d15bc545b958789bd7e74" title="Release ownership. ">release()</a>  <a href="#a2b45b66bfcb4fd6a03c998dd8e21d27e">More...</a><br /></td></tr>
<tr class="separator:a2b45b66bfcb4fd6a03c998dd8e21d27e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab555508a557440f9d2e27bd5f8223ea7"><td class="memItemLeft" align="right" valign="top">Boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d90/interfaceSemaphore.html#ab555508a557440f9d2e27bd5f8223ea7">trywait</a> ()</td></tr>
<tr class="memdesc:ab555508a557440f9d2e27bd5f8223ea7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to get a signal, return false when not possible, same as acquire(false)  <a href="#ab555508a557440f9d2e27bd5f8223ea7">More...</a><br /></td></tr>
<tr class="separator:ab555508a557440f9d2e27bd5f8223ea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a172821036c61bf18f75953175227c4fa"><td class="memItemLeft" align="right" valign="top">Boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da6/interfaceLock.html#a172821036c61bf18f75953175227c4fa">acquire</a> (Boolean blocking=true)</td></tr>
<tr class="memdesc:a172821036c61bf18f75953175227c4fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acquire.  <a href="#a172821036c61bf18f75953175227c4fa">More...</a><br /></td></tr>
<tr class="separator:a172821036c61bf18f75953175227c4fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad11a1833268d15bc545b958789bd7e74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da6/interfaceLock.html#ad11a1833268d15bc545b958789bd7e74">release</a> ()</td></tr>
<tr class="memdesc:ad11a1833268d15bc545b958789bd7e74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release ownership.  <a href="#ad11a1833268d15bc545b958789bd7e74">More...</a><br /></td></tr>
<tr class="separator:ad11a1833268d15bc545b958789bd7e74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b88dbc459449d2280338e5b702a68b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/interfaceobject.html#a6b88dbc459449d2280338e5b702a68b4">dispose</a> ()</td></tr>
<tr class="memdesc:a6b88dbc459449d2280338e5b702a68b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force dispose object immediately.  <a href="#a6b88dbc459449d2280338e5b702a68b4">More...</a><br /></td></tr>
<tr class="separator:a6b88dbc459449d2280338e5b702a68b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac61f07a7d6c5471293371086af3186bd"><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/interfaceobject.html#ac61f07a7d6c5471293371086af3186bd">toString</a> ()</td></tr>
<tr class="memdesc:ac61f07a7d6c5471293371086af3186bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return string representation of object, normally is "[Native Object]" and can be implemented by object itself.  <a href="#ac61f07a7d6c5471293371086af3186bd">More...</a><br /></td></tr>
<tr class="separator:ac61f07a7d6c5471293371086af3186bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad66be13eb5b7c5f560fd8511565138c4"><td class="memItemLeft" align="right" valign="top">Value&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/interfaceobject.html#ad66be13eb5b7c5f560fd8511565138c4">toJSON</a> (String key=&quot;&quot;)</td></tr>
<tr class="memdesc:ad66be13eb5b7c5f560fd8511565138c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return JSON representation of object, normally is readable attributes collection.  <a href="#ad66be13eb5b7c5f560fd8511565138c4">More...</a><br /></td></tr>
<tr class="separator:ad66be13eb5b7c5f560fd8511565138c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9261a7662bc8bb4a898bc15dc16f206"><td class="memItemLeft" align="right" valign="top">Value&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d38/interfaceobject.html#ab9261a7662bc8bb4a898bc15dc16f206">valueOf</a> ()</td></tr>
<tr class="memdesc:ab9261a7662bc8bb4a898bc15dc16f206"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return JSON representation of object.  <a href="#ab9261a7662bc8bb4a898bc15dc16f206">More...</a><br /></td></tr>
<tr class="separator:ab9261a7662bc8bb4a898bc15dc16f206"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="../../dc/d90/interfaceSemaphore.html" title="Semaphore object. ">Semaphore</a> object. </p>
<p><a class="el" href="../../dc/d90/interfaceSemaphore.html" title="Semaphore object. ">Semaphore</a> has a counter inside, descrease one after calling acquire and wait, increase one after calling release and post. Counter will be not negative because thread will in sleep when counter is 0, until other threads use release or post to increase counter.</p>
<p><a class="el" href="../../dc/d90/interfaceSemaphore.html" title="Semaphore object. ">Semaphore</a> is commonly used limited resource usage and producer/consumer model application.</p>
<p>Use database as an example to limit concurrency: </p><div class="fragment"><div class="line">var maxconnections = 5;</div>
<div class="line">var l = <span class="keyword">new</span> coroutine.Semaphore(maxconnections);</div>
<div class="line"></div>
<div class="line">......</div>
<div class="line"></div>
<div class="line">l.acquire();</div>
<div class="line">var conn = connectdb()</div>
<div class="line">.....</div>
<div class="line">conn.close();</div>
<div class="line">l.release();</div>
</div><!-- fragment --><p>Producer/consumer model usually use with semaphore and queue together. Producer post data and consumer wait for it. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="adf61e8770130c9f386c7c78934028379"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Semaphore::Semaphore </td>
          <td>(</td>
          <td class="paramtype">Integer&#160;</td>
          <td class="paramname"><em>value</em> = <code>1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>Counter initial value </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab144395cba916969214bbe60f7521fed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Semaphore::wait </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait for semaphore, same as acquire(true) </p>

</div>
</div>
<a class="anchor" id="a2b45b66bfcb4fd6a03c998dd8e21d27e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Semaphore::post </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Post a semaphore, same as <a class="el" href="../../de/da6/interfaceLock.html#ad11a1833268d15bc545b958789bd7e74" title="Release ownership. ">release()</a> </p>

</div>
</div>
<a class="anchor" id="ab555508a557440f9d2e27bd5f8223ea7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Boolean Semaphore::trywait </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to get a signal, return false when not possible, same as acquire(false) </p>
<dl class="section return"><dt>Returns</dt><dd>Return true when successful </dd></dl>

</div>
</div>
<a class="anchor" id="a172821036c61bf18f75953175227c4fa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Boolean Lock::acquire </td>
          <td>(</td>
          <td class="paramtype">Boolean&#160;</td>
          <td class="paramname"><em>blocking</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Acquire. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blocking</td><td>Indicates whether to wait, default is true </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return true when acquired successfully</dd></dl>
<p>acquire returns true immediately when lock if acquirable.</p>
<p>When is not available and blocking is true, will wait and return true.</p>
<p>When is not available and blocking is false, returns false immediately. </p>

</div>
</div>
<a class="anchor" id="ad11a1833268d15bc545b958789bd7e74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Lock::release </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Release ownership. </p>
<p>This method releases ownership of lock, and throw an error when ownership is invalid. </p>

</div>
</div>
<a class="anchor" id="a6b88dbc459449d2280338e5b702a68b4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">object::dispose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Force dispose object immediately. </p>

</div>
</div>
<a class="anchor" id="ac61f07a7d6c5471293371086af3186bd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">String object::toString </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return string representation of object, normally is "[Native Object]" and can be implemented by object itself. </p>
<dl class="section return"><dt>Returns</dt><dd>Return string representation </dd></dl>

<p>Implemented in <a class="el" href="../../d9/dae/interfaceBuffer.html#a704ee70a5949e3ce5e3ed9efffbfd054">Buffer</a>.</p>

</div>
</div>
<a class="anchor" id="ad66be13eb5b7c5f560fd8511565138c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Value object::toJSON </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>key</em> = <code>&quot;&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return JSON representation of object, normally is readable attributes collection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Not used </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return JSON representation </dd></dl>

</div>
</div>
<a class="anchor" id="ab9261a7662bc8bb4a898bc15dc16f206"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Value object::valueOf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return JSON representation of object. </p>
<dl class="section return"><dt>Returns</dt><dd>Return JSON representation of object </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<style type="text/css">
body {
	color: #666666;
}
a, .contents a:visited {
	color: #3399ee;
}
.icona, #nav-sync {
  display:none;
}
.directory td.entry, .directory td.desc {
  padding: 8px;
}
</style>
</body>
</html>
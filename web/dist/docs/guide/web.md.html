<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="initial-scale=1,maximum-scale=1,user-scalable=no"><link rel=icon type=image/png href=../../imgs/icon.png><title> é«˜æ€§èƒ½ Web åº”ç”¨ç¨‹åºå®è·µ - JavaScript on Fiber</title><link href=../../css/common.css rel=stylesheet><link href=../../css/docs.css rel=stylesheet></head><body><div class="navbar navbar-default navbar-static-top" role=navigation><div class=container><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navbar aria-expanded=false aria-controls=navbar><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=../../index.html><img src=../../imgs/logo-dark.png></a></div><div id=navbar class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right notranslate"><li><a href=../../index.html>HOME</a></li><li><a href=readme.md.html>GUIDE</a></li><li><a href=../manual/module/readme.md.html>MODULE</a></li><li><a href=../manual/object/readme.md.html>OBJECT</a></li><li><a href=../awesome/readme.md.html>AWESOME</a></li><li><a href=../../download/index.html>DOWNLOAD</a></li><li class="nav-item dropdown"><a href=# data-toggle=dropdown aria-haspopup=true aria-expanded=false>LANGUAGE</a><div class=dropdown-menu><a href=../../docs/guide/web.md.html>ä¸­æ–‡</a> <a href=../../ca/docs/guide/web.md.html>Catalan</a> <a href=../../de/docs/guide/web.md.html>Deutsch</a> <a href=../../en/docs/guide/web.md.html>English</a> <a href=../../es/docs/guide/web.md.html>EspaÃ±ol</a> <a href=../../fr/docs/guide/web.md.html>FranÃ§ais</a> <a href=../../gl/docs/guide/web.md.html>Galego</a> <a href=../../it/docs/guide/web.md.html>Italiano</a> <a href=../../nl/docs/guide/web.md.html>Nederlands</a> <a href=../../ru/docs/guide/web.md.html>Ğ ÑƒÑÑĞºĞ¸Ğ¹</a> <a href=../../ja/docs/guide/web.md.html>æ—¥æœ¬èª</a> <a href=../../ko/docs/guide/web.md.html>í•œêµ­ì–´</a> <a href=../../zh-tw/docs/guide/web.md.html>ç¹é«”ä¸­æ–‡</a></div></li></ul></div></div></div><div class=band><div class=container><span class=group> Guide å¼€å‘æŒ‡å— </span><div class=search><input type=text class=searchbox placeholder=Search></div></div></div><div class=container><ol class=breadcrumb><li><a href=../../index.html>é¦–é¡µ</a></li><li><a href=readme.md.html> å¼€å‘æŒ‡å— </a></li><li class=active> é«˜æ€§èƒ½ Web åº”ç”¨ç¨‹åºå®è·µ </li></ol></div><div class=page-body><div class=container><div class="sidebar hidden-xs"><div class=panel-group id=accordion role=tablist>  <div class=panel><div class=panel-heading role=tab id=headingOne><h4 class=panel-title><a data-toggle=collapse data-parent=#accordion href="#collapse_guide" aria-controls="collapse_guide"> å¼€å‘æŒ‡å— </a></h4></div><div id="collapse_guide" class="panel-collapse collapse in" aria-labelledby=headingOne><div class=panel-body> <ul>
<li><a href=about.md.html>fibjs æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href=install.md.html>å®‰è£…è¿è¡Œç¯å¢ƒ</a></li>
<li><a href=hello.md.html class ="notranslate">hello, world</a></li>
<li><a href=test.md.html>ç¾å¥½ç”Ÿæ´»ä»æµ‹è¯•å¼€å§‹</a></li>
<li><a href=profiler.md.html>æ‰¾å‡ºæ€§èƒ½æ€æ‰‹</a></li>
<li><a href=sync.md.html>åŒæ­¥å’Œå¼‚æ­¥</a></li>
<li><a href=server-hot-update.md.html>æœåŠ¡ç«¯æ¨¡å—çƒ­æ›´æ–°</a></li>
<li class="active"><a href=web.md.html>é«˜æ€§èƒ½ Web åº”ç”¨ç¨‹åºå®è·µ</a></li>
<li><a href=host-routes.md.html>åŸŸåè·¯ç”±</a></li>
<li><a href=x509.md.html>fibjs ä¸­ X509 è¯ä¹¦çš„ä½¿ç”¨</a></li>
<li><a href=contribute.md.html>æ·»åŠ  native æ¨¡å—</a></li>
</ul>
 </div></div></div>  <div class=panel><div class=panel-heading role=tab id=headingOne><h4 class=panel-title><a data-toggle=collapse data-parent=#accordion href="#collapse_module" aria-controls="collapse_module"> åŸºç¡€æ¨¡å— </a></h4></div><div id="collapse_module" class="panel-collapse collapse " aria-labelledby=headingOne><div class=panel-body> <ul>
<li><a href=../manual/module/ifs/assert.md.html class ="notranslate">assert</a></li>
<li><a href=../manual/module/ifs/base32.md.html class ="notranslate">base32</a></li>
<li><a href=../manual/module/ifs/base58.md.html class ="notranslate">base58</a></li>
<li><a href=../manual/module/ifs/base64.md.html class ="notranslate">base64</a></li>
<li><a href=../manual/module/ifs/child_process.md.html class ="notranslate">child_process</a></li>
<li><a href=../manual/module/ifs/console.md.html class ="notranslate">console</a></li>
<li><a href=../manual/module/ifs/constants.md.html class ="notranslate">constants</a></li>
<li><a href=../manual/module/ifs/coroutine.md.html class ="notranslate">coroutine</a></li>
<li><a href=../manual/module/ifs/crypto.md.html class ="notranslate">crypto</a></li>
<li><a href=../manual/module/ifs/db.md.html class ="notranslate">db</a></li>
<li><a href=../manual/module/ifs/dgram.md.html class ="notranslate">dgram</a></li>
<li><a href=../manual/module/ifs/dns.md.html class ="notranslate">dns</a></li>
<li><a href=../manual/module/ifs/encoding.md.html class ="notranslate">encoding</a></li>
<li><a href=../manual/module/ifs/fs.md.html class ="notranslate">fs</a></li>
<li><a href=../manual/module/ifs/fs_constants.md.html class ="notranslate">fs_constants</a></li>
<li><a href=../manual/module/ifs/gd.md.html class ="notranslate">gd</a></li>
<li><a href=../manual/module/ifs/global.md.html class ="notranslate">global</a></li>
<li><a href=../manual/module/ifs/gui.md.html class ="notranslate">gui</a></li>
<li><a href=../manual/module/ifs/hash.md.html class ="notranslate">hash</a></li>
<li><a href=../manual/module/ifs/hex.md.html class ="notranslate">hex</a></li>
<li><a href=../manual/module/ifs/http.md.html class ="notranslate">http</a></li>
<li><a href=../manual/module/ifs/iconv.md.html class ="notranslate">iconv</a></li>
<li><a href=../manual/module/ifs/io.md.html class ="notranslate">io</a></li>
<li><a href=../manual/module/ifs/json.md.html class ="notranslate">json</a></li>
<li><a href=../manual/module/ifs/mq.md.html class ="notranslate">mq</a></li>
<li><a href=../manual/module/ifs/msgpack.md.html class ="notranslate">msgpack</a></li>
<li><a href=../manual/module/ifs/multibase.md.html class ="notranslate">multibase</a></li>
<li><a href=../manual/module/ifs/net.md.html class ="notranslate">net</a></li>
<li><a href=../manual/module/ifs/os.md.html class ="notranslate">os</a></li>
<li><a href=../manual/module/ifs/path.md.html class ="notranslate">path</a></li>
<li><a href=../manual/module/ifs/path_posix.md.html class ="notranslate">path_posix</a></li>
<li><a href=../manual/module/ifs/path_win32.md.html class ="notranslate">path_win32</a></li>
<li><a href=../manual/module/ifs/perf_hooks.md.html class ="notranslate">perf_hooks</a></li>
<li><a href=../manual/module/ifs/performance.md.html class ="notranslate">performance</a></li>
<li><a href=../manual/module/ifs/process.md.html class ="notranslate">process</a></li>
<li><a href=../manual/module/ifs/profiler.md.html class ="notranslate">profiler</a></li>
<li><a href=../manual/module/ifs/punycode.md.html class ="notranslate">punycode</a></li>
<li><a href=../manual/module/ifs/querystring.md.html class ="notranslate">querystring</a></li>
<li><a href=../manual/module/ifs/registry.md.html class ="notranslate">registry</a></li>
<li><a href=../manual/module/ifs/ssl.md.html class ="notranslate">ssl</a></li>
<li><a href=../manual/module/ifs/string_decoder.md.html class ="notranslate">string_decoder</a></li>
<li><a href=../manual/module/ifs/test.md.html class ="notranslate">test</a></li>
<li><a href=../manual/module/ifs/timers.md.html class ="notranslate">timers</a></li>
<li><a href=../manual/module/ifs/tty.md.html class ="notranslate">tty</a></li>
<li><a href=../manual/module/ifs/url.md.html class ="notranslate">url</a></li>
<li><a href=../manual/module/ifs/util.md.html class ="notranslate">util</a></li>
<li><a href=../manual/module/ifs/uuid.md.html class ="notranslate">uuid</a></li>
<li><a href=../manual/module/ifs/vm.md.html class ="notranslate">vm</a></li>
<li><a href=../manual/module/ifs/worker_threads.md.html class ="notranslate">worker_threads</a></li>
<li><a href=../manual/module/ifs/ws.md.html class ="notranslate">ws</a></li>
<li><a href=../manual/module/ifs/xml.md.html class ="notranslate">xml</a></li>
<li><a href=../manual/module/ifs/zip.md.html class ="notranslate">zip</a></li>
<li><a href=../manual/module/ifs/zlib.md.html class ="notranslate">zlib</a></li>
</ul>
 </div></div></div>  <div class=panel><div class=panel-heading role=tab id=headingOne><h4 class=panel-title><a data-toggle=collapse data-parent=#accordion href="#collapse_object" aria-controls="collapse_object"> å†…ç½®å¯¹è±¡ </a></h4></div><div id="collapse_object" class="panel-collapse collapse " aria-labelledby=headingOne><div class=panel-body> <ul>
<li><a href=../manual/object/ifs/blskey.md.html class ="notranslate">BlsKey</a></li>
<li><a href=../manual/object/ifs/buffer.md.html class ="notranslate">Buffer</a></li>
<li><a href=../manual/object/ifs/bufferedstream.md.html class ="notranslate">BufferedStream</a></li>
<li><a href=../manual/object/ifs/chain.md.html class ="notranslate">Chain</a></li>
<li><a href=../manual/object/ifs/childprocess.md.html class ="notranslate">ChildProcess</a></li>
<li><a href=../manual/object/ifs/cipher.md.html class ="notranslate">Cipher</a></li>
<li><a href=../manual/object/ifs/condition.md.html class ="notranslate">Condition</a></li>
<li><a href=../manual/object/ifs/dbconnection.md.html class ="notranslate">DbConnection</a></li>
<li><a href=../manual/object/ifs/dgramsocket.md.html class ="notranslate">DgramSocket</a></li>
<li><a href=../manual/object/ifs/digest.md.html class ="notranslate">Digest</a></li>
<li><a href=../manual/object/ifs/eckey.md.html class ="notranslate">ECKey</a></li>
<li><a href=../manual/object/ifs/ed25519key.md.html class ="notranslate">Ed25519Key</a></li>
<li><a href=../manual/object/ifs/event.md.html class ="notranslate">Event</a></li>
<li><a href=../manual/object/ifs/eventemitter.md.html class ="notranslate">EventEmitter</a></li>
<li><a href=../manual/object/ifs/fswatcher.md.html class ="notranslate">FSWatcher</a></li>
<li><a href=../manual/object/ifs/fiber.md.html class ="notranslate">Fiber</a></li>
<li><a href=../manual/object/ifs/file.md.html class ="notranslate">File</a></li>
<li><a href=../manual/object/ifs/handler.md.html class ="notranslate">Handler</a></li>
<li><a href=../manual/object/ifs/heapgraphedge.md.html class ="notranslate">HeapGraphEdge</a></li>
<li><a href=../manual/object/ifs/heapgraphnode.md.html class ="notranslate">HeapGraphNode</a></li>
<li><a href=../manual/object/ifs/heapsnapshot.md.html class ="notranslate">HeapSnapshot</a></li>
<li><a href=../manual/object/ifs/httpclient.md.html class ="notranslate">HttpClient</a></li>
<li><a href=../manual/object/ifs/httpcollection.md.html class ="notranslate">HttpCollection</a></li>
<li><a href=../manual/object/ifs/httpcookie.md.html class ="notranslate">HttpCookie</a></li>
<li><a href=../manual/object/ifs/httphandler.md.html class ="notranslate">HttpHandler</a></li>
<li><a href=../manual/object/ifs/httpmessage.md.html class ="notranslate">HttpMessage</a></li>
<li><a href=../manual/object/ifs/httprepeater.md.html class ="notranslate">HttpRepeater</a></li>
<li><a href=../manual/object/ifs/httprequest.md.html class ="notranslate">HttpRequest</a></li>
<li><a href=../manual/object/ifs/httpresponse.md.html class ="notranslate">HttpResponse</a></li>
<li><a href=../manual/object/ifs/httpserver.md.html class ="notranslate">HttpServer</a></li>
<li><a href=../manual/object/ifs/httpuploaddata.md.html class ="notranslate">HttpUploadData</a></li>
<li><a href=../manual/object/ifs/httpsserver.md.html class ="notranslate">HttpsServer</a></li>
<li><a href=../manual/object/ifs/image.md.html class ="notranslate">Image</a></li>
<li><a href=../manual/object/ifs/iterator.md.html class ="notranslate">Iterator</a></li>
<li><a href=../manual/object/ifs/leveldb.md.html class ="notranslate">LevelDB</a></li>
<li><a href=../manual/object/ifs/lock.md.html class ="notranslate">Lock</a></li>
<li><a href=../manual/object/ifs/lrucache.md.html class ="notranslate">LruCache</a></li>
<li><a href=../manual/object/ifs/memorystream.md.html class ="notranslate">MemoryStream</a></li>
<li><a href=../manual/object/ifs/message.md.html class ="notranslate">Message</a></li>
<li><a href=../manual/object/ifs/mongocollection.md.html class ="notranslate">MongoCollection</a></li>
<li><a href=../manual/object/ifs/mongocursor.md.html class ="notranslate">MongoCursor</a></li>
<li><a href=../manual/object/ifs/mongodb.md.html class ="notranslate">MongoDB</a></li>
<li><a href=../manual/object/ifs/mongoid.md.html class ="notranslate">MongoID</a></li>
<li><a href=../manual/object/ifs/mysql.md.html class ="notranslate">MySQL</a></li>
<li><a href=../manual/object/ifs/odbc.md.html class ="notranslate">Odbc</a></li>
<li><a href=../manual/object/ifs/pkey.md.html class ="notranslate">PKey</a></li>
<li><a href=../manual/object/ifs/rangestream.md.html class ="notranslate">RangeStream</a></li>
<li><a href=../manual/object/ifs/redis.md.html class ="notranslate">Redis</a></li>
<li><a href=../manual/object/ifs/redishash.md.html class ="notranslate">RedisHash</a></li>
<li><a href=../manual/object/ifs/redislist.md.html class ="notranslate">RedisList</a></li>
<li><a href=../manual/object/ifs/redisset.md.html class ="notranslate">RedisSet</a></li>
<li><a href=../manual/object/ifs/redissortedset.md.html class ="notranslate">RedisSortedSet</a></li>
<li><a href=../manual/object/ifs/routing.md.html class ="notranslate">Routing</a></li>
<li><a href=../manual/object/ifs/sqlite.md.html class ="notranslate">SQLite</a></li>
<li><a href=../manual/object/ifs/sandbox.md.html class ="notranslate">SandBox</a></li>
<li><a href=../manual/object/ifs/seekablestream.md.html class ="notranslate">SeekableStream</a></li>
<li><a href=../manual/object/ifs/semaphore.md.html class ="notranslate">Semaphore</a></li>
<li><a href=../manual/object/ifs/service.md.html class ="notranslate">Service</a></li>
<li><a href=../manual/object/ifs/smtp.md.html class ="notranslate">Smtp</a></li>
<li><a href=../manual/object/ifs/socket.md.html class ="notranslate">Socket</a></li>
<li><a href=../manual/object/ifs/sslhandler.md.html class ="notranslate">SslHandler</a></li>
<li><a href=../manual/object/ifs/sslserver.md.html class ="notranslate">SslServer</a></li>
<li><a href=../manual/object/ifs/sslsocket.md.html class ="notranslate">SslSocket</a></li>
<li><a href=../manual/object/ifs/stat.md.html class ="notranslate">Stat</a></li>
<li><a href=../manual/object/ifs/statswatcher.md.html class ="notranslate">StatsWatcher</a></li>
<li><a href=../manual/object/ifs/stream.md.html class ="notranslate">Stream</a></li>
<li><a href=../manual/object/ifs/stringdecoder.md.html class ="notranslate">StringDecoder</a></li>
<li><a href=../manual/object/ifs/ttyinputstream.md.html class ="notranslate">TTYInputStream</a></li>
<li><a href=../manual/object/ifs/ttyoutputstream.md.html class ="notranslate">TTYOutputStream</a></li>
<li><a href=../manual/object/ifs/tcpserver.md.html class ="notranslate">TcpServer</a></li>
<li><a href=../manual/object/ifs/textdecoder.md.html class ="notranslate">TextDecoder</a></li>
<li><a href=../manual/object/ifs/textencoder.md.html class ="notranslate">TextEncoder</a></li>
<li><a href=../manual/object/ifs/timer.md.html class ="notranslate">Timer</a></li>
<li><a href=../manual/object/ifs/urlobject.md.html class ="notranslate">UrlObject</a></li>
<li><a href=../manual/object/ifs/websocket.md.html class ="notranslate">WebSocket</a></li>
<li><a href=../manual/object/ifs/websocketmessage.md.html class ="notranslate">WebSocketMessage</a></li>
<li><a href=../manual/object/ifs/webview.md.html class ="notranslate">WebView</a></li>
<li><a href=../manual/object/ifs/worker.md.html class ="notranslate">Worker</a></li>
<li><a href=../manual/object/ifs/x509cert.md.html class ="notranslate">X509Cert</a></li>
<li><a href=../manual/object/ifs/x509crl.md.html class ="notranslate">X509Crl</a></li>
<li><a href=../manual/object/ifs/x509req.md.html class ="notranslate">X509Req</a></li>
<li><a href=../manual/object/ifs/xmlattr.md.html class ="notranslate">XmlAttr</a></li>
<li><a href=../manual/object/ifs/xmlcdatasection.md.html class ="notranslate">XmlCDATASection</a></li>
<li><a href=../manual/object/ifs/xmlcharacterdata.md.html class ="notranslate">XmlCharacterData</a></li>
<li><a href=../manual/object/ifs/xmlcomment.md.html class ="notranslate">XmlComment</a></li>
<li><a href=../manual/object/ifs/xmldocument.md.html class ="notranslate">XmlDocument</a></li>
<li><a href=../manual/object/ifs/xmldocumenttype.md.html class ="notranslate">XmlDocumentType</a></li>
<li><a href=../manual/object/ifs/xmlelement.md.html class ="notranslate">XmlElement</a></li>
<li><a href=../manual/object/ifs/xmlnamednodemap.md.html class ="notranslate">XmlNamedNodeMap</a></li>
<li><a href=../manual/object/ifs/xmlnode.md.html class ="notranslate">XmlNode</a></li>
<li><a href=../manual/object/ifs/xmlnodelist.md.html class ="notranslate">XmlNodeList</a></li>
<li><a href=../manual/object/ifs/xmlprocessinginstruction.md.html class ="notranslate">XmlProcessingInstruction</a></li>
<li><a href=../manual/object/ifs/xmltext.md.html class ="notranslate">XmlText</a></li>
<li><a href=../manual/object/ifs/zipfile.md.html class ="notranslate">ZipFile</a></li>
<li><a href=../manual/object/ifs/object.md.html class ="notranslate">object</a></li>
</ul>
 </div></div></div>  <div class=panel><div class=panel-heading role=tab id=headingOne><h4 class=panel-title><a data-toggle=collapse data-parent=#accordion href="#collapse_awesome" aria-controls="collapse_awesome"> ç¤¾åŒºæ¨¡å— </a></h4></div><div id="collapse_awesome" class="panel-collapse collapse " aria-labelledby=headingOne><div class=panel-body> <ul>
<li><a href=../awesome/module/fib-session.md.html class ="notranslate">fib-session</a></li>
<li><a href=../awesome/module/fib-pool.md.html class ="notranslate">fib-pool</a></li>
<li><a href=../awesome/module/fib-orm.md.html class ="notranslate">fib-orm</a></li>
<li><a href=../awesome/module/fib-app.md.html class ="notranslate">fib-app</a></li>
<li><a href=../awesome/module/fib-kv.md.html class ="notranslate">fib-kv</a></li>
<li><a href=../awesome/module/fib-rpc.md.html class ="notranslate">fib-rpc</a></li>
<li><a href=../awesome/module/fib-qr.md.html class ="notranslate">fib-qr</a></li>
<li><a href=../awesome/module/fib-pug.md.html class ="notranslate">fib-pug</a></li>
<li><a href=../awesome/module/ejs.md.html class ="notranslate">ejs</a></li>
<li><a href=../awesome/module/juicer.md.html class ="notranslate">Juicer</a></li>
<li><a href=../awesome/module/highlight.js.md.html class ="notranslate">highlight.js</a></li>
<li><a href=../awesome/module/marked.md.html class ="notranslate">marked</a></li>
<li><a href=../awesome/module/node-cron.md.html class ="notranslate">node-cron</a></li>
<li><a href=../awesome/module/debug.md.html class ="notranslate">debug</a></li>
<li><a href=../awesome/module/benchmark.js.md.html class ="notranslate">benchmark.js</a></li>
<li><a href=../awesome/module/sinon.md.html class ="notranslate">sinon</a></li>
<li><a href=../awesome/module/node-mime.md.html class ="notranslate">node-mime</a></li>
<li><a href=../awesome/module/validatorjs.md.html class ="notranslate">validatorjs</a></li>
<li><a href=../awesome/module/superstruct.md.html class ="notranslate">superstruct</a></li>
<li><a href=../awesome/module/cluster-server.md.html class ="notranslate">cluster-server</a></li>
<li><a href=../awesome/module/synaptic.md.html class ="notranslate">synaptic</a></li>
<li><a href=../awesome/module/source-map.md.html class ="notranslate">source-map</a></li>
<li><a href=../awesome/module/json-format.md.html class ="notranslate">json-format</a></li>
<li><a href=../awesome/module/viz.js.md.html class ="notranslate">viz.js</a></li>
<li><a href=../awesome/module/nomnoml.md.html class ="notranslate">nomnoml</a></li>
<li><a href=../awesome/module/pegjs.md.html class ="notranslate">pegjs</a></li>
<li><a href=../awesome/module/uglify-js.md.html class ="notranslate">uglify-js</a></li>
<li><a href=../awesome/module/js-beautify.md.html class ="notranslate">js-beautify</a></li>
<li><a href=../awesome/module/chalk-animation.md.html class ="notranslate">chalk-animation</a></li>
<li><a href=../awesome/module/jsrsasign.md.html class ="notranslate">jsrsasign</a></li>
<li><a href=../awesome/module/crypto-js.md.html class ="notranslate">crypto-js</a></li>
<li><a href=../awesome/module/ascii-table.md.html class ="notranslate">ascii-table</a></li>
<li><a href=../awesome/module/logstream.md.html class ="notranslate">logstream</a></li>
<li><a href=../awesome/module/ci.md.html class ="notranslate">ci</a></li>
<li><a href=../awesome/module/fs-readdir-recursive.md.html class ="notranslate">fs-readdir-recursive</a></li>
<li><a href=../awesome/module/mkdirp.md.html class ="notranslate">mkdirp</a></li>
<li><a href=../awesome/module/rmdirr.md.html class ="notranslate">rmdirr</a></li>
<li><a href=../awesome/module/detect-port.md.html class ="notranslate">detect-port</a></li>
<li><a href=../awesome/module/bitcoinjs-lib.md.html class ="notranslate">bitcoinjs-lib</a></li>
<li><a href=../awesome/module/rakuten.md.html class ="notranslate">Rakuten</a></li>
</ul>
 </div></div></div>  </div></div><div class=content><div class=social-share data-sites=weibo,twitter data-description=åˆ†äº«></div> <h1 id="é«˜æ€§èƒ½-Web-åº”ç”¨ç¨‹åºå®è·µ">é«˜æ€§èƒ½ Web åº”ç”¨ç¨‹åºå®è·µ</h1>
<h2 id="ä»‹ç»">ä»‹ç»</h2>
<p>fibjs æ˜¯ä¸€ä¸ªä¸»è¦ä¸º Web åç«¯å¼€å‘è€Œè®¾è®¡çš„é«˜æ€§èƒ½åº”ç”¨æœåŠ¡å™¨æ¡†æ¶ã€‚å®ƒå»ºç«‹åœ¨ Google v8 JavaScript å¼•æ“åŸºç¡€ä¸Šï¼Œå¹¶ä¸”é€‰æ‹©äº†å’Œä¼ ç»Ÿçš„ callback ä¸åŒçš„å¹¶å‘è§£å†³æ–¹æ¡ˆã€‚fibjs åˆ©ç”¨ fibers åœ¨æ¡†æ¶å±‚éš”ç¦»äº†å¼‚æ­¥è°ƒç”¨å¸¦æ¥çš„ä¸šåŠ¡å¤æ‚æ€§ï¼Œæå¤§é™ä½äº†å¼€å‘éš¾åº¦ï¼Œå¹¶å‡å°‘å› ä¸ºç”¨æˆ·ç©ºé—´é¢‘ç¹å¼‚æ­¥å¤„ç†å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<p>fibjs çš„è®¾è®¡éå¸¸æ³¨é‡æ€§èƒ½ï¼Œå†…ç½®çš„ç½‘ç»œ IO å’Œ HTTP æ¨¡å—é‡‡ç”¨äº†åŸºäºäº‹ä»¶é©±åŠ¨çš„éé˜»å¡ I/O æ¨¡å‹ï¼Œå¼€å‘è€…å¯ä»¥å¾ˆå®¹æ˜“åœ°å®ç°é«˜å¯é æ€§çš„æœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚è€Œä¸”ç”±äºåº•å±‚æ˜¯ç”± C++ å®ç°çš„ï¼Œfibjs çš„æ€§èƒ½è¡¨ç°éå¸¸ä¼˜è¶Šï¼Œå¯ä»¥è½»æ¾åœ°åº”å¯¹é«˜å¹¶å‘çš„è®¿é—®ï¼Œæä¾›æä¸ºç¨³å®šå’Œå¯é çš„æœåŠ¡ã€‚</p>
<p>åŒæ—¶ï¼Œfibjs ä¹Ÿæ”¯æŒ WebSocketï¼Œè¿™æ˜¯ä¸€ç§åŸºäº TCP åè®®çš„å…¨åŒå·¥é€šä¿¡åè®®ï¼Œåœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹èµ·ä¸€ä¸ªä¸æ–­å¼€çš„è¿æ¥ï¼Œå¯ä»¥å®ç°å®æ—¶åŒå‘æ•°æ®ä¼ è¾“ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒä»»æ„æ ¼å¼çš„æ•°æ®ä¼ è¾“ã€‚åˆ©ç”¨ WebSocket å¯ä»¥è½»æ¾åœ°å®ç°é€šä¿¡æ•ˆæœæ›´åŠ ä¼˜ç§€çš„å®æ—¶é€šä¿¡åº”ç”¨ã€‚</p>
<p>æ€»ä¹‹ï¼Œfibjs æ—¢å¼ºè°ƒäº†é«˜æ€§èƒ½å’Œé«˜å¯é æ€§ï¼Œåˆæä¾›äº† WebSocket è¿™æ ·çš„å®æ—¶é€šä¿¡ç‰¹æ€§ï¼Œæ˜¯ä¸€æ¬¾éå¸¸é€‚åˆå¼€å‘é«˜é€Ÿ Web åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚</p>
<h2 id="å¼€å‘ç¯å¢ƒæ­å»º">å¼€å‘ç¯å¢ƒæ­å»º</h2>
<p>åœ¨å¼€å§‹è¿›è¡Œ fibjs çš„å¼€å‘ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå‡†å¤‡å¥½å¼€å‘ç¯å¢ƒã€‚æœ¬ç« èŠ‚å°†ä»‹ç»å¦‚ä½•å®‰è£… fibjsï¼Œå¦‚ä½•ä½¿ç”¨ fibjs å·¥å…·åˆå§‹åŒ–é¡¹ç›®ä»¥åŠå¦‚ä½•ä½¿ç”¨ IDE é›†æˆå¼€å‘ç¯å¢ƒã€‚</p>
<h3 id="å®‰è£…-fibjs">å®‰è£… fibjs</h3>
<p>é’ˆå¯¹ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œå®‰è£… fibjs çš„æ–¹å¼ä¹Ÿç•¥æœ‰ä¸åŒã€‚</p>
<p>å¯¹äº Linux å’Œ macOS ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å®‰è£… fibjsï¼š</p>
<pre><code class="lang-sh"><div class="line-numbers">1</div>curl -s https://fibjs.org/download/installer.sh | sh
</code></pre>
<p>å¦‚æœä½¿ç”¨ macOS å¹¶ä¸”ä½¿ç”¨äº† Homebrew åŒ…ç®¡ç†å™¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š</p>
<pre><code class="lang-sh"><div class="line-numbers">1</div>brew install fibjs
</code></pre>
<p>å¯¹äº Windows ç”¨æˆ·ï¼Œéœ€è¦ä» fibjs å®˜ç½‘ ä¸‹è½½å®‰è£…ç¨‹åºï¼Œç„¶åæŒ‰ç…§æŒ‡ç¤ºè¿›è¡Œå®‰è£…ã€‚</p>
<h3 id="ä½¿ç”¨-fibjs-â€“init-åˆ›å»ºæ–°é¡¹ç›®">ä½¿ç”¨ fibjs â€“init åˆ›å»ºæ–°é¡¹ç›®</h3>
<p>åœ¨å®‰è£…å¥½ fibjs åï¼Œå¯ä»¥ä½¿ç”¨ fibjs å·¥å…·æ¥å¿«é€Ÿåˆ›å»ºæ–°é¡¹ç›®ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸºç¡€çš„é¡¹ç›®æ¨¡æ¿ï¼š</p>
<pre><code class="lang-sh"><div class="line-numbers">1</div>fibjs --init
</code></pre>
<p>è¯¥å‘½ä»¤å°†åœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ç»“æ„ï¼Œå…¶ä¸­åŒ…æ‹¬ package.jsonï¼Œç”¨æ¥å­˜å‚¨é¡¹ç›®çš„åŸºæœ¬ä¿¡æ¯ï¼Œä»¥åŠä¾èµ–ä¿¡æ¯ã€‚</p>
<h2 id="ç¼–å†™-Web-åº”ç”¨ç¨‹åº">ç¼–å†™ Web åº”ç”¨ç¨‹åº</h2>
<p>Web åº”ç”¨ç¨‹åºå¼€å‘æ˜¯ç›®å‰ fibjs æœ€å¸¸ç”¨çš„ä¸€ç§åº”ç”¨åœºæ™¯ï¼Œfibjs æä¾›äº†ä¸€ç³»åˆ—å·¥å…·å’Œæ¨¡å—å¸®åŠ©æˆ‘ä»¬æ›´å¿«é€Ÿåœ°æ„å»º Web åº”ç”¨ç¨‹åºã€‚</p>
<h3 id="ç¼–å†™-HTTP-æœåŠ¡å™¨">ç¼–å†™ HTTP æœåŠ¡å™¨</h3>
<ul>
<li>å…ˆå¯¼å…¥ http æ¨¡å—ï¼›</li>
<li>å®ä¾‹åŒ– http.Serverï¼Œç›‘å¬è¯·æ±‚ã€‚</li>
<li>æœåŠ¡å™¨é€šè¿‡ start å‡½æ•°å¯åŠ¨ã€‚</li>
</ul>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6</div><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);

<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> http.Server(<span class="hljs-number">8080</span>, (req) =&gt; {
    req.response.write(<span class="hljs-string">'Hello World!'</span>);
});
server.start();
</code></pre>
<h3 id="è§£æ-URL-å‚æ•°å’Œè¯·æ±‚ä½“">è§£æ URL å‚æ•°å’Œè¯·æ±‚ä½“</h3>
<p>è§£æ url å‚æ•°å’Œè¯·æ±‚ä½“éå¸¸é‡è¦ï¼Œåº”ç”¨äºå„ç§æœåŠ¡ç«¯åº”ç”¨ç¨‹åºã€‚åœ¨ fibjs ä¸­å¯ä»¥ç›´æ¥é€šè¿‡ req.query è§£æä¼ å…¥çš„ url å‚æ•°ï¼Œè€Œè¯·æ±‚ä½“æ˜¯é€šè¿‡ req.body è¯»å–ã€‚</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8</div><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);

<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> http.Server(<span class="hljs-number">8080</span>, (req) =&gt; {
    <span class="hljs-keyword">var</span> name = req.query.get(<span class="hljs-string">'name'</span>);
    <span class="hljs-keyword">var</span> msg = name ? <span class="hljs-string">`Hello <span class="hljs-subst">${name}</span>!`</span> : <span class="hljs-string">'Hello world!'</span>;
    req.response.write(msg);
});
server.start();
</code></pre>
<h3 id="å®ç°æ¥å£è®¿é—®æ§åˆ¶">å®ç°æ¥å£è®¿é—®æ§åˆ¶</h3>
<p>é€šè¿‡æ¥å£é™åˆ¶ç”¨æˆ·è®¿é—®æ˜¯éå¸¸å¸¸è§çš„ä¸€ç§åœºæ™¯ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10</div><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);

<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> http.Server(<span class="hljs-number">8080</span>, (req) =&gt; {
    <span class="hljs-keyword">if</span> (req.headers.get(<span class="hljs-string">'auth'</span>) === <span class="hljs-string">'ok'</span>) {
        req.response.write(<span class="hljs-string">'Hello World!'</span>);
    } <span class="hljs-keyword">else</span> {
        req.response.write(<span class="hljs-string">'Access Denied!'</span>);
    }
});
server.start();
</code></pre>
<h3 id="å¢åŠ è·¯ç”±å¤„ç†">å¢åŠ è·¯ç”±å¤„ç†</h3>
<p>è·¯ç”±æ˜¯ä¸€ä¸ªWebåº”ç”¨ç¨‹åºä¸­æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼Œè·¯ç”±å°±æ˜¯æŒ‡å°†æ¥æ”¶åˆ°çš„è¯·æ±‚æŒ‰ç…§ä¸€å®šè§„åˆ™åˆ†å‘åˆ°å¤„ç†å™¨ä¸­å»ã€‚åœ¨ fibjsï¼Œä½ å¯ä»¥è‡ªå·±ç¼–å†™è·¯ç”±æ¨¡å—ï¼Œå¹¶ç»‘å®šåˆ° http server ä¸­ï¼Œç„¶åé€šè¿‡è‡ªå®šä¹‰çš„è·¯ç”±è§£æè¿›è¡ŒURLåŒ¹é…ä»¥åŠå¯¹åº”çš„å¤„ç†ã€‚</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9</div><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);
<span class="hljs-keyword">const</span> { Router } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mq'</span>);

<span class="hljs-keyword">var</span> router = <span class="hljs-keyword">new</span> Router();
router.get(<span class="hljs-string">'/hello/:name'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, name</span>) </span>{
    req.response.write(<span class="hljs-string">'hello, '</span> + name);
});
<span class="hljs-keyword">var</span> svr = <span class="hljs-keyword">new</span> http.Server(<span class="hljs-number">8080</span>, router);
svr.start();
</code></pre>
<p>ä»¥ä¸Šä¾‹å­ä¹Ÿå¯ä»¥ç”¨æ›´ç®€å•çš„è¯­æ³•å®ç°ï¼š</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8</div><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);

<span class="hljs-keyword">var</span> svr = <span class="hljs-keyword">new</span> http.Server(<span class="hljs-number">8080</span>, {
    <span class="hljs-string">'/hello/:name'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, name</span>) </span>{
        req.response.write(<span class="hljs-string">'hello, '</span> + name);
    }
});
svr.start();
</code></pre>
<h3 id="é”™è¯¯å¤„ç†ä¸æ—¥å¿—è®°å½•">é”™è¯¯å¤„ç†ä¸æ—¥å¿—è®°å½•</h3>
<p>åœ¨ fibjs ä¸­ä½ å¯ä»¥é€šè¿‡ try-catch å—æ•è·é€»è¾‘å¼‚å¸¸ï¼Œé€šè¿‡è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶è¿›è¡Œè°ƒå¼è®°å½•ï¼›è‹¥ä¸ºè‡´å‘½æ€§å¼‚å¸¸ï¼Œå¯ä»¥ç›´æ¥æŠ›å‡ºç»™ä¸Šå±‚æ¡†æ¶è¿›è¡Œå¤„ç†ã€‚</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10</div><span class="hljs-keyword">const</span> <span class="hljs-built_in">console</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'console'</span>);
<span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);

<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> http.Server(<span class="hljs-number">8080</span>, (req) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// ...</span>
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-built_in">console</span>.log(e.message, e.stack);
    }
});
</code></pre>
<h2 id="WebSocket">WebSocket</h2>
<p>WebSocket åè®®æ˜¯ä¸€ç§åŸºäº TCP åè®®çš„å…¨åŒå·¥é€šä¿¡åè®®ï¼Œåœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹èµ·ä¸€ä¸ªä¸æ–­å¼€çš„è¿æ¥ï¼Œå¯ä»¥å®ç°å®æ—¶åŒå‘æ•°æ®ä¼ è¾“ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒä»»æ„æ ¼å¼çš„æ•°æ®ä¼ è¾“ã€‚åœ¨ fibjs ä¸­ï¼ŒWebSocket æ”¯æŒæ¨¡å—æä¾›äº†ç›¸åº”çš„ API æ¥å£ï¼Œå¯ä»¥å®ç° WebSocket æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„å¼€å‘ã€‚</p>
<h3 id="ä½¿ç”¨-fibjs-åŸç”Ÿ-WebSocket-æ¨¡å—å®ç°-WebSocket-æœåŠ¡å™¨ç«¯">ä½¿ç”¨ fibjs åŸç”Ÿ WebSocket æ¨¡å—å®ç° WebSocket æœåŠ¡å™¨ç«¯</h3>
<p>åœ¨æœåŠ¡å™¨ç«¯ï¼Œå¯ä»¥é€šè¿‡ upgrade å‡½æ•°å°† HTTP è¯·æ±‚è½¬æ¢ä¸º WebSocket è¿æ¥ã€‚åœ¨åˆ›å»º http server å¯¹è±¡çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ ws.upgrade(callback) å¹¶å°†å…¶ä¼ å…¥ http.start() æ–¹æ³•ï¼Œå®ç°å°† http è¯·æ±‚è½¬æ¢ä¸º WebSocket çš„æ“ä½œã€‚</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</div><span class="hljs-keyword">var</span> ws = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ws'</span>);
<span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);

<span class="hljs-keyword">var</span> server = <span class="hljs-keyword">new</span> http.Server(<span class="hljs-number">8080</span>, {
  <span class="hljs-string">'/ws'</span>: ws.upgrade(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">conn, req</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'a client connected.'</span>);

    <span class="hljs-comment">// listening for message events</span>
    conn.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'received message: '</span>, evt.data);
      <span class="hljs-comment">// echo the message back to client</span>
      conn.send(<span class="hljs-string">'Server: '</span> + evt.data);
    };

    <span class="hljs-comment">// listening for close events</span>
    conn.onclose = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code, reason</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'closed.'</span>);
    };

    <span class="hljs-comment">// listening for error events</span>
    conn.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
      <span class="hljs-built_in">console</span>.log(err);
    };
  })
});

server.start();
</code></pre>
<p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›‘å¬åˆ°å®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯äº‹ä»¶åŠæœåŠ¡å™¨ä¸å®¢æˆ·ç«¯è¿æ¥å…³é—­äº‹ä»¶ã€‚å½“æœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯åï¼Œä¼šå°†ç›¸åŒçš„æ¶ˆæ¯å‘é€å›å®¢æˆ·ç«¯ã€‚æ­¤æ—¶å®ç°äº†ç®€å•çš„ WebSocket ç‚¹å¯¹ç‚¹é€šä¿¡ã€‚</p>
<h3 id="å®ç°ä¸æ•°æ®å­˜å‚¨çš„äº¤äº’">å®ç°ä¸æ•°æ®å­˜å‚¨çš„äº¤äº’</h3>
<p>å½“ä½¿ç”¨ WebSocket è¿›è¡Œé€šä¿¡çš„æ—¶å€™ï¼Œé™¤äº†å•çº¯æ¶ˆæ¯çš„æ”¶å‘ä¹‹å¤–ï¼Œè¿˜éœ€è¦è€ƒè™‘æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨å’ŒæŸ¥è¯¢ç­‰æ“ä½œã€‚è¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ°æ•°æ®åº“ï¼Œå¯ä»¥ä½¿ç”¨ fibjs å†…ç½®çš„ db æ¨¡å—ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚</p>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</div><span class="hljs-keyword">var</span> ws = <span class="hljs-built_in">require</span>(<span class="hljs-string">"ws"</span>);
<span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">var</span> db = <span class="hljs-built_in">require</span>(<span class="hljs-string">"db"</span>);

<span class="hljs-comment">// open a mysql connection</span>
<span class="hljs-keyword">var</span> mysql = db.openMySQL(<span class="hljs-string">"mysql://root:password@localhost/dbname"</span>);

<span class="hljs-keyword">var</span> server = <span class="hljs-keyword">new</span> http.Server(<span class="hljs-number">8080</span>, {
  <span class="hljs-string">"/ws"</span>: ws.upgrade(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">conn, req</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"a client connected."</span>);

    <span class="hljs-comment">// listening for message events</span>
    conn.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"received message: "</span>, evt.data);

      <span class="hljs-comment">// use execute to query the data</span>
      <span class="hljs-keyword">var</span> rs = mysql.execute(<span class="hljs-string">"SELECT * FROM user WHERE name=?"</span>, evt.data.toString());
      conn.send(<span class="hljs-built_in">JSON</span>.stringify(rs));
    };

    <span class="hljs-comment">// listening for close events</span>
    conn.onclose = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code, reason</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"closed."</span>);
    };

    <span class="hljs-comment">// listening for error events</span>
    conn.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
      <span class="hljs-built_in">console</span>.log(err);
    };
  })
});

server.start();
</code></pre>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨äº† db æ¨¡å—çš„ openMySQL æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ª MySQL æ•°æ®åº“è¿æ¥å¯¹è±¡ mysqlï¼Œç„¶ååœ¨ç›‘å¬åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯åï¼Œä½¿ç”¨ execute æ–¹æ³•ç›´æ¥æ‰§è¡Œ SQL æŸ¥è¯¢ï¼Œè·å–æ»¡è¶³æ¡ä»¶çš„è®°å½•ã€‚æœ€åå°†æŸ¥è¯¢ç»“æœé€šè¿‡ WebSocket åè®®å‘é€å›å®¢æˆ·ç«¯ã€‚</p>
<p>éœ€è¦æ³¨æ„ï¼Œåœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œéœ€è¦åšå¥½å¼‚å¸¸å¤„ç†å’Œæ•°æ®çš„å®‰å…¨æ€§ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œé€šè¿‡ db æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿è½»æ¾åœ°è¿›è¡Œä¸æ•°æ®åº“çš„äº¤äº’ï¼Œç»“åˆ WebSocket åè®®ï¼Œå®ç°é¢å‘å®æ—¶ã€é«˜æ€§èƒ½çš„ Web åº”ç”¨ç¨‹åºã€‚</p>
<h3 id="å®ç°-WebSocket-å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯é€šä¿¡">å®ç° WebSocket å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯é€šä¿¡</h3>
<p>åœ¨å®¢æˆ·ç«¯ï¼Œå¯ä»¥é€šè¿‡åˆ›å»º WebSocket å®ä¾‹å¹¶æŒ‡å®š URL æ¥è¿æ¥ WebSocket æœåŠ¡å™¨ï¼Œç„¶åå°†æ¶ˆæ¯å‘é€ç»™æœåŠ¡å™¨ã€‚</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</div><span class="hljs-keyword">var</span> ws = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ws'</span>);

<span class="hljs-comment">// create a WebSocket object and connect to ws://localhost:8080/ws</span>
<span class="hljs-keyword">var</span> conn = <span class="hljs-keyword">new</span> ws.Socket(<span class="hljs-string">'ws://localhost:8080/ws'</span>);

<span class="hljs-comment">// listening for open events</span>
conn.onopen = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  conn.send(<span class="hljs-string">'hello'</span>);
}

<span class="hljs-comment">// listening for message events</span>
conn.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'received message:'</span>, evt.data);
}

<span class="hljs-comment">// listening for close events</span>
conn.onclose = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code, reason</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'closed.'</span>);
}

<span class="hljs-comment">// listening for error events</span>
conn.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
  <span class="hljs-built_in">console</span>.log(err);
}
</code></pre>
<p>åœ¨ä¸Šè¿°å®¢æˆ·ç«¯ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª WebSocket å®ä¾‹å¹¶æŒ‡å®šå…¶ URLï¼Œåœ¨è¿æ¥å»ºç«‹æˆåŠŸåå°±å¯ä»¥å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯äº†ã€‚å½“æœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯åï¼Œä¼šå°†ç›¸åŒçš„æ¶ˆæ¯å‘é€å›å®¢æˆ·ç«¯ã€‚æ­¤æ—¶å®ç°äº†ç®€å•çš„ WebSocket ç‚¹å¯¹ç‚¹é€šè®¯ã€‚</p>
<h3 id="WebSocket-çš„ä¼˜åŠ¿å’Œä½¿ç”¨åœºæ™¯">WebSocket çš„ä¼˜åŠ¿å’Œä½¿ç”¨åœºæ™¯</h3>
<p>WebSocket åè®®å…·æœ‰å…¸å‹çš„åŒå‘é€šä¿¡æ¨¡å‹ï¼Œå…è®¸æœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ï¼Œå¸¸å¸¸è¢«ç”¨äºå®ç°èŠå¤©ã€åœ¨çº¿æ¸¸æˆç­‰éœ€è¦å®æ—¶è€Œå³æ—¶æ€§é«˜çš„åœºåˆã€‚ç›¸æ¯”å…¶ä»–ä¼ è¾“åè®®ï¼ŒWebSocket åè®®å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<p>â€¢ å®æ—¶æ€§é«˜ï¼Œæ”¯æŒåŒå‘é€šä¿¡
â€¢ åè®®è§„èŒƒç®€å•ï¼Œä½¿ç”¨æ–¹ä¾¿
â€¢ èƒ½å¤Ÿå¤„ç†å¤§é‡å¹¶å‘è¿æ¥
â€¢ æ”¯æŒé•¿è¿æ¥ï¼Œå‡å°‘ç½‘ç»œä¼ è¾“çš„æ—¶é—´æ¶ˆè€—</p>
<p>WebSocket æœ€å¸¸è§çš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ç½‘é¡µèŠå¤©ã€æ¸¸æˆå¯¹æˆ˜ã€åœ¨çº¿æ’­æ”¾å’Œå³æ—¶é€šè®¯ç­‰ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œé€šè¿‡ WebSocket æ”¯æŒæ¨¡å—ï¼Œå®ç°èµ·æ¥ååˆ†ç®€å•ï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿæ„å»ºè‡ªå·±çš„ Web åº”ç”¨ç¨‹åºã€‚</p>
<h2 id="å•å…ƒæµ‹è¯•">å•å…ƒæµ‹è¯•</h2>
<h3 id="æµ‹è¯•æ¡†æ¶å’Œæµ‹è¯•æ–¹æ³•">æµ‹è¯•æ¡†æ¶å’Œæµ‹è¯•æ–¹æ³•</h3>
<p>åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæµ‹è¯•æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç¯èŠ‚ï¼Œå•å…ƒæµ‹è¯•æ˜¯å…¶ä¸­çš„é‡è¦ä¸€ç¯ï¼Œé€šè¿‡å•å…ƒæµ‹è¯•å¯ä»¥æœ‰æ•ˆåœ°éªŒè¯ä»£ç æ˜¯å¦æ»¡è¶³è®¾è®¡å’Œéœ€æ±‚ï¼Œä»¥åŠé¿å…ä»£ç ä¿®æ”¹æ—¶å¼•å…¥çš„é”™è¯¯ã€‚ä¸€èˆ¬åœ°ï¼Œå•å…ƒæµ‹è¯•çš„åŸåˆ™æ˜¯å¯¹æ¯ä¸ªå‡½æ•°å’Œæ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼Œä¿è¯æ¯ä¸ªå‡½æ•°å’Œæ–¹æ³•çš„è¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>æµ‹è¯•æ¡†æ¶æ˜¯ç”¨æ¥ç¼–å†™ã€è¿è¡Œå’ŒéªŒè¯æµ‹è¯•ç”¨ä¾‹çš„ä»£ç åº“ï¼Œå®ƒæä¾›äº†æµ‹è¯•ç”¨ä¾‹çš„ç®¡ç†ã€è¿è¡Œå’ŒæŠ¥å‘Šç­‰åŠŸèƒ½ã€‚åœ¨ JavaScript å’Œ Node.js ä¸­ï¼Œæµè¡Œçš„å•å…ƒæµ‹è¯•æ¡†æ¶æœ‰ Mochaã€Jest å’Œ Jasmine ç­‰ã€‚åœ¨ fibjs ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰è‡ªå·±çš„æµ‹è¯•æ¡†æ¶ï¼Œå³ test æ¨¡å—ã€‚</p>
<p>åœ¨å•å…ƒæµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬é‡‡ç”¨çš„æµ‹è¯•æ–¹æ³•åŒ…æ‹¬é»‘ç›’æµ‹è¯•å’Œç™½ç›’æµ‹è¯•ä¸¤ç§æ–¹æ³•ã€‚</p>
<p>é»‘ç›’æµ‹è¯•æ˜¯ä¸€ç§æµ‹è¯•æ–¹æ³•ï¼Œå®ƒåªè€ƒè™‘å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºï¼Œè€Œä¸è€ƒè™‘å‡½æ•°å†…éƒ¨çš„å®ç°ç»†èŠ‚ã€‚é»‘ç›’æµ‹è¯•åŸºäºéœ€æ±‚åˆ†æå’Œè®¾è®¡è§„æ ¼ä¹¦ï¼Œé€šè¿‡æµ‹è¯•ç”¨ä¾‹åˆ†æå’Œæ‰§è¡Œï¼Œåˆ¤æ–­ç¨‹åºæ˜¯å¦å‡ºç°é€»è¾‘é”™è¯¯ã€è¾¹ç•Œé”™è¯¯ä»¥åŠå®‰å…¨æ€§é—®é¢˜ç­‰ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯æµ‹è¯•è¿‡ç¨‹ç®€å•ï¼Œæµ‹è¯•ç»“æœå¯é ï¼Œç¼ºç‚¹æ˜¯æµ‹è¯•æ— æ³•è¦†ç›–æ‰€æœ‰çš„ç¨‹åºè·¯å¾„ã€‚</p>
<p>ç™½ç›’æµ‹è¯•æ˜¯ä¸€ç§æµ‹è¯•æ–¹æ³•ï¼Œå®ƒè€ƒè™‘å‡½æ•°çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼ŒåŒ…æ‹¬æ¡ä»¶è¯­å¥ã€å¾ªç¯è¯­å¥ã€é€’å½’ä»¥åŠä»£ç çš„è¦†ç›–ç‡ç­‰ã€‚é€šè¿‡è¿™äº›æµ‹è¯•ï¼Œå¯ä»¥å‘ç°åœ¨å…±äº«æ•°æ®å’Œä»£ç ä¹‹é—´çš„äº¤äº’ä¸­å¯èƒ½å­˜åœ¨çš„é—®é¢˜ã€‚ç™½ç›’æµ‹è¯•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è¦†ç›–æ‰€æœ‰çš„ç¨‹åºè·¯å¾„ï¼Œç¼ºç‚¹æ˜¯æµ‹è¯•è¿‡ç¨‹è¾ƒä¸ºå¤æ‚ï¼Œæµ‹è¯•ç»“æœå—åˆ°ç¯å¢ƒå’Œå®ç°æ–¹æ³•çš„å½±å“ã€‚</p>
<h3 id="ä½¿ç”¨-test-æ¨¡å—ç¼–å†™æµ‹è¯•ç”¨ä¾‹">ä½¿ç”¨ test æ¨¡å—ç¼–å†™æµ‹è¯•ç”¨ä¾‹</h3>
<p>åœ¨ fibjs ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ test æ¨¡å—ç¼–å†™ web server çš„æµ‹è¯•ç”¨ä¾‹ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10
11
12
13
14</div><span class="hljs-keyword">var</span> test = <span class="hljs-built_in">require</span>(<span class="hljs-string">'test'</span>);
test.setup();

<span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);

describe(<span class="hljs-string">'Web server test'</span>, () =&gt; {
    it(<span class="hljs-string">'should return hello world'</span>, () =&gt; {
        <span class="hljs-keyword">var</span> r = http.get(<span class="hljs-string">'http://localhost:8080/hello'</span>);
        assert.equal(r.statusCode, <span class="hljs-number">200</span>);
        assert.equal(r.data.toString(), <span class="hljs-string">'Hello World'</span>);
    });
});

test.run();
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ describe å’Œ it å‡½æ•°åˆ†åˆ«å®šä¹‰æµ‹è¯•æ¨¡å—å’Œæµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶ä½¿ç”¨ assert å‡½æ•°è¿›è¡Œæ–­è¨€éªŒè¯ã€‚</p>
<p>åœ¨ describe å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¤šä¸ª it å‡½æ•°æ¥åˆ†åˆ«æµ‹è¯•ä¸åŒçš„åœºæ™¯ã€‚åœ¨æ¯ä¸ª it å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ http.get å‡½æ•°æ¥æ¨¡æ‹Ÿ HTTP GET è¯·æ±‚ï¼Œè·å–è¯·æ±‚å“åº”å¹¶è¿›è¡Œ assertTrue å’Œ assertEqual ç­‰æ–­è¨€éªŒè¯ã€‚</p>
<p>é€šè¿‡ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æµ‹è¯•å‡½æ•°å’Œæ¨¡å—çš„æ­£ç¡®æ€§ï¼Œä¿è¯äº§å“è´¨é‡ï¼ŒåŒæ—¶ä¹Ÿå¯åŠ å¼ºä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p>
<h2 id="çƒ­æ›´æ–°">çƒ­æ›´æ–°</h2>
<p>çƒ­æ›´æ–°æŒ‡çš„æ˜¯åœ¨ä¸åœæ­¢æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œå®ç°æœåŠ¡ç«¯ä»£ç çš„æ›´æ–°ã€‚åœ¨ç¨‹åºå¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†å¿«é€Ÿè¿­ä»£ï¼Œç»å¸¸éœ€è¦è¿›è¡Œä»£ç è°ƒæ•´ï¼Œä»¥åŠæ·»åŠ æ–°åŠŸèƒ½ã€‚ä½¿ç”¨çƒ­æ›´æ–°å¯ä»¥åœ¨ä¸åœæ­¢æœåŠ¡çš„å‰æä¸‹ï¼Œä½¿ç”¨æ–°çš„ä»£ç ï¼Œæ›´åŠ é«˜æ•ˆçš„å®Œæˆè¿­ä»£å·¥ä½œã€‚</p>
<p>åœ¨ fibjs ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ SandBox æ¨¡å—å®ç°å¹³æ»‘çš„çƒ­æ›´æ–°ã€‚SandBox æ¨¡å—å¯ä»¥æä¾›ä¸€ä¸ªå®‰å…¨çš„æ‰§è¡Œç¯å¢ƒï¼Œæ¨¡æ‹Ÿå…¨å±€å˜é‡ç­‰åŠŸèƒ½ã€‚å…·ä½“å®ç°å¯ä»¥å‚è€ƒä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ul>
<li>åŠ è½½éœ€è¦æ›´æ–°çš„ä»£ç æ–‡ä»¶ï¼ˆæ¯”å¦‚ web.jsï¼‰ã€‚</li>
<li>é€šè¿‡ SandBoxï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å®‰å…¨æ¨¡å—ï¼Œåœ¨è¯¥æ¨¡å—ä¸­åŠ è½½ web.jsï¼Œç”Ÿæˆå®‰å…¨æ¨¡å—ã€‚é€šè¿‡ç”Ÿæˆçš„å®‰å…¨æ¨¡å—é‡æ–°æŒ‚è½½æ­£åœ¨è¿è¡Œçš„æœåŠ¡çš„ handlerã€‚</li>
<li>æœåŠ¡å™¨ç»§ç»­å¤„ç†ä¹‹å‰çš„è¯·æ±‚ï¼Œæ–°çš„è¯·æ±‚å°†è¢«æŒ‚è½½åœ¨æ–°çš„ handler ä¸Šã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ SandBox æ¨¡å—å®ç°å¹³æ»‘çƒ­æ›´æ–°çš„ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</div><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);
<span class="hljs-keyword">const</span> { SandBox } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vm'</span>);

<span class="hljs-keyword">let</span> FILE_PATH = <span class="hljs-string">'./web.js'</span>;
<span class="hljs-keyword">let</span> handler = <span class="hljs-keyword">new</span> SandBox().require(FILE_PATH).handler;

<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> http.Server(<span class="hljs-number">8080</span>, handler);

server.start();

fs.watch(FILE_PATH, (event, filename) =&gt; {
  handler = <span class="hljs-keyword">new</span> SandBox().require(FILE_PATH).handler;
  server.handler = handler;
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`[<span class="hljs-subst">${<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleString()}</span>] server reloaded.`</span>);
});
</code></pre>
<p>è¿™ä»½ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨ç¨‹åºå¯åŠ¨æ—¶é¦–å…ˆåŠ è½½ä¸€æ¬¡ web.js ä¸­çš„ä»£ç ï¼Œéšååˆ›å»º SandBox å®ä¾‹ï¼Œå¹¶åœ¨å®ä¾‹ä¸­åŠ è½½ä»£ç ã€‚ä¹‹åæˆ‘ä»¬æ–°å»ºäº†ä¸€ä¸ª HTTP Serverï¼Œä½¿ç”¨ handler ä¸­çš„æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚</p>
<p>åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ fs.watch ç›‘å¬ web.js æ–‡ä»¶çš„å˜åŒ–ï¼Œä¸€æ—¦æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œæˆ‘ä»¬é‡æ–°åŠ è½½ä»£ç ï¼Œæ›´æ–° handler ä¸­çš„å®ç°ã€‚</p>
<h2 id="æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–</h2>
<p>åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦é¢å¯¹æ€§èƒ½é—®é¢˜ã€‚ä¼˜åŒ–ä»£ç ï¼Œæé«˜æ€§èƒ½ï¼Œæ˜¯å¼€å‘è€…å¿…å¤‡æŠ€èƒ½ä¹‹ä¸€ã€‚åœ¨ fibjs ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ CPU Profiler æ¥å¸®åŠ©æˆ‘ä»¬åˆ†æç¨‹åºçš„è¿è¡ŒçŠ¶æ€ï¼Œä¼˜åŒ–ä»£ç ã€‚</p>
<p>åœ¨ fibjs ä¸­ï¼Œåªéœ€è¦ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•° --profï¼Œå¯åŠ¨ fibjsï¼Œå³å¯ä»¥å¯åŠ¨ CPU Profilerï¼ˆé»˜è®¤é—´éš”æ˜¯ 1000msï¼‰ã€‚å¦‚æœéœ€è¦æ›´é«˜ç²¾åº¦çš„åˆ†ææ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨--prof-intervalå‚æ•°ï¼Œè®¾ç½®æ—¥å¿—é—´éš”ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="lang-sh"><div class="line-numbers">1
2</div>$ fibjs --prof test.js   <span class="hljs-comment"># å¯åŠ¨ CPU Profilerï¼Œé»˜è®¤ä»¥ 1000ms ä¸ºé—´éš”</span>
$ fibjs --prof --prof-interval=10ms test.js <span class="hljs-comment"># å¯åŠ¨ CPU Profilerï¼Œä»¥ 10000usï¼ˆå³ 10msï¼‰ä¸ºé—´éš”</span>
</code></pre>
<p>å½“ fibjs è¿è¡Œå®Œæˆä¹‹åï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæºæ–‡ä»¶åç›®å½•ï¼Œè¿™ä¸ªç›®å½•é‡ŒåŒ…å«äº†ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶å’Œä¸€äº›è¾…åŠ©æ–‡ä»¶ã€‚æ—¥å¿—æ–‡ä»¶çš„é»˜è®¤åå­—ä¸º fibjs-xxxx.logï¼Œå…¶ä¸­ xxxx æ˜¯ä¸€ä¸ªæ—¶é—´æˆ³ã€‚å¯ä»¥ä½¿ç”¨ --log é€‰é¡¹æ¥æŒ‡å®šæ—¥å¿—æ–‡ä»¶åã€‚æ­¤æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>--prof-process</code> å¤„ç†ç”Ÿæˆçš„æ—¥å¿—ï¼š</p>
<pre><code class="lang-sh"><div class="line-numbers">1</div>fibjs --prof-process fibjs-xxxx.log prof.svg
</code></pre>
<p>è¿è¡Œç»“æŸï¼Œä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ prof.svgï¼Œå³å¯æŸ¥çœ‹æ­¤æ¬¡æ—¥å¿—çš„ç«ç„°å›¾ï¼š
<img src="./imgs/prof.svg" alt="prof">
ä½ å¯ä»¥ç‚¹å‡»æŸ¥çœ‹å…¨å°ºå¯¸çš„å›¾ç‰‡ï¼Œåœ¨å…¨å°ºå¯¸å›¾ç‰‡ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡é¼ æ ‡æ“ä½œï¼ŒæŸ¥é˜…æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼š<a href="./imgs/prof.svg">prof.svg</a>ã€‚</p>
<p>ç”Ÿæˆçš„ç«ç„°å›¾ä¸­ï¼Œæ¯ä¸€ä¸ªè‰²å—ï¼Œä»£è¡¨ä¸€ä¸ªè®°å½•ç‚¹ï¼Œè‰²å—è¶Šé•¿ï¼Œè¡¨ç¤ºè¢«è®°å½•çš„æ¬¡æ•°è¶Šå¤šï¼›æ¯ä¸€è¡Œä»£è¡¨ä¸€å±‚è°ƒç”¨å †æ ˆï¼Œå±‚æ•°è¶Šå¤šè¡¨ç¤ºè°ƒç”¨çš„å±‚æ•°è¶Šå¤šï¼›è°ƒç”¨å †æ ˆçš„æ‘†æ”¾ï¼Œæ˜¯å€’ç½®çš„ï¼Œè¶Šé ä¸‹çš„è‰²å—ï¼Œè¶Šæ˜¯æœ€åˆçš„å‡½æ•°ã€‚</p>
<p>è‰²å—çš„é¢œè‰²æœ‰ä¸¤ç±»ï¼Œä¸€ç±»æ˜¯çº¢è‰²ï¼Œä¸€ç±»æ˜¯è“è‰²ã€‚åœ¨ fibjs çš„ profiler é‡Œï¼Œçº¢è‰²ä»£è¡¨  JavaScript è¿ç®—ï¼Œè“è‰²ä»£è¡¨ io æ“ä½œæˆ–è€… Native è¿ç®—ã€‚æ ¹æ®ä½ éœ€è¦è§£å†³çš„é—®é¢˜ä¸åŒï¼Œæ‰€éœ€è¦å…³æ³¨çš„åŒºåŸŸä¹Ÿä¼šä¸åŒã€‚æ¯”å¦‚ä½ éœ€è¦è§£å†³ cpu å ç”¨è¿‡é«˜çš„é—®é¢˜ï¼Œæ­¤æ—¶éœ€è¦å…³æ³¨çº¢è‰²çš„è‰²å—ï¼›è€Œå¦‚æœä½ çš„åº”ç”¨ï¼Œcpu å ç”¨ä¸é«˜ï¼Œä½†æ˜¯å“åº”å´æ¯”è¾ƒæ…¢ï¼Œå°±å°±éœ€è¦å…³æ³¨è“è‰²çš„è‰²å—ã€‚é è¿‘é¡¶éƒ¨è¶Šå¤§çš„è‰²å—ï¼Œè¶Šæ˜¯éœ€è¦å…³æ³¨å’Œä¼˜åŒ–çš„é‡ç‚¹ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•é’ˆå¯¹å ç”¨ CPU èµ„æºè¾ƒå¤šçš„å‡½æ•°åšè°ƒæ•´ï¼Œé€šè¿‡å¼‚æ­¥æ–¹å¼å®ç°IOç­‰ï¼Œæˆ–è€…åœ¨ç¼–å†™æ—¶ä¼˜åŒ–ä»£ç ã€‚</p>
<h2 id="éƒ¨ç½²ä¸Šçº¿">éƒ¨ç½²ä¸Šçº¿</h2>
<p>ä¸ºäº†ä½¿æˆ‘ä»¬çš„é¡¹ç›®èƒ½å¤Ÿè¿è¡Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œç¼–è¯‘å’Œéƒ¨ç½²ã€‚è¿™é‡Œæˆ‘ä»¬ä»‹ç»å¦‚ä½•ä½¿ç”¨ package.json æ–‡ä»¶é…ç½®ç¼–è¯‘å’Œéƒ¨ç½²ã€‚</p>
<p>åœ¨é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ package.json æ¥ç®¡ç†é¡¹ç›®ä¾èµ–ã€é…ç½®ç¼–è¯‘å’Œéƒ¨ç½²ã€‚ä»¥ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ package.json ä¸ºä¾‹ï¼š</p>
<pre><code class="lang-JavaScript"><div class="line-numbers">1
2
3
4
5
6
7</div>{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"my-project"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"fib-pool"</span>: <span class="hljs-string">"^1.0.0"</span>
  }
}
</code></pre>
<p>å½“æˆ‘ä»¬éœ€è¦ç¼–è¯‘å¹¶éƒ¨ç½²é¡¹ç›®æ—¶ï¼Œåªéœ€è¦åœ¨ç»ˆç«¯è¿›å…¥é¡¹ç›®ç›®å½•ï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="lang-sh"><div class="line-numbers">1</div>fibjs --install
</code></pre>
<p>è¯¥å‘½ä»¤ä¼šè‡ªåŠ¨å®‰è£…é¡¹ç›®æ‰€ä¾èµ–çš„æ¨¡å—ã€‚ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨é¡¹ç›®ï¼š</p>
<pre><code class="lang-sh"><div class="line-numbers">1</div>fibjs app.js
</code></pre>
<p>ğŸ‘‰ ã€<a href=host-routes.md.html>åŸŸåè·¯ç”±</a>ã€‘</p>
 </div><div class="sidebar hidden-sm hidden-xs hidden-md"><div id=toc></div></div></div></div><div class=footer><div class=container>&copy; Copyright 2012-2021 fibjs.org | <a href=../../support.html>æ”¯æŒæˆ‘ä»¬</a></div></div><a id=back-to-top href=# class="btn btn-default btn-lg back-to-top" role=button title="" data-toggle=tooltip data-placement=left><span class="glyphicon glyphicon-chevron-up"></span></a><script type=text/javascript src=https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js></script><script type=text/javascript src=../../js/common.js></script><script type=text/javascript src=../../js/docs.js></script></body></html>